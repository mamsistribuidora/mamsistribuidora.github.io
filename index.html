<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAM Distribuidora | Plataforma Profissional</title>
    <style>
        :root { --gold: #FFD700; --blue: #002d5a; --card: rgba(10, 10, 10, 0.98); }
        body { 
            font-family: 'Segoe UI', sans-serif; margin: 0; min-height: 100vh; color: #fff;
            background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('https://images.unsplash.com/photo-1598488035139-bdbb2231ce04?auto=format&fit=crop&w=1470&q=80'); 
            background-size: cover; background-attachment: fixed; background-position: center;
        }
        .sidebar { width: 280px; background: #000; height: 100vh; position: fixed; border-right: 2px solid var(--blue); display: none; flex-direction: column; padding: 20px; box-sizing: border-box; z-index: 1000; overflow-y: auto; }
        .main { width: 100%; box-sizing: border-box; }
        .logged-main { padding-left: 280px; }
        @media (max-width: 900px) { .logged-main { padding-left: 0; } .sidebar { width: 100%; height: auto; position: relative; } }
        .section { padding: 25px; display: none; max-width: 1200px; margin: auto; }
        .active-section { display: block; }
        .card { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; border-left: 4px solid var(--gold); }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #444; color: #fff; border-radius: 6px; }
        input:focus { border-color: var(--gold); outline: none; }
        .btn-gold { background: var(--gold); color: #000; padding: 14px; border: none; border-radius: 6px; font-weight: bold; width: 100%; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        .nav-item { padding: 14px; cursor: pointer; border-bottom: 1px solid #222; transition: 0.3s; }
        .nav-item:hover { background: var(--blue); color: #fff; }
        .profile-pic { width: 90px; height: 90px; border-radius: 50%; border: 3px solid var(--gold); object-fit: cover; display: block; margin: auto; }
        footer { background: #000; padding: 30px; text-align: center; border-top: 2px solid var(--blue); }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; text-transform: uppercase; }
        .pendente { background: #ffae00; color: #000; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="authPage" style="height:95vh; display:flex; align-items:center; justify-content:center; padding:20px;">
        <div class="card" style="width:100%; max-width:400px; text-align:center;">
            <h1 style="color:var(--gold); margin:0;">MAM</h1>
            <div id="loginBox">
                <input type="email" id="lEmail" placeholder="E-mail da Conta">
                <input type="password" id="lPass" placeholder="Palavra-passe">
                <button class="btn-gold" onclick="autenticar()">Aceder ao Painel</button>
                <p onclick="irParaRegisto()" style="color:var(--gold); cursor:pointer; margin-top:15px;">Criar nova conta de Artista</p>
            </div>
            <div id="regBox" class="hidden">
                <input type="text" id="rNome" placeholder="Nome Art√≠stico/Completo">
                <input type="email" id="rEmail" placeholder="E-mail">
                <input type="password" id="rPass" placeholder="Criar Senha">
                <button class="btn-gold" onclick="registrar()">Finalizar Registo</button>
                <p onclick="irParaLogin()" style="color:var(--gold); cursor:pointer; margin-top:15px;">J√° tenho conta</p>
            </div>
        </div>
    </div>

    <nav id="sidebar" class="sidebar">
        <div style="text-align:center; margin-bottom:20px;">
            <img id="sidePic" src="https://via.placeholder.com/100" class="profile-pic">
            <p id="sideNome" style="color:var(--gold); font-weight:bold; margin-top:12px;"></p>
        </div>
        <div class="nav-item" onclick="navegar('home')">üè† P√°gina Inicial</div>
        <div class="nav-item" onclick="navegar('perfil')">üë§ Gerir Perfil</div>
        <div class="nav-item" onclick="navegar('lancar')">üöÄ Enviar M√∫sica</div>
        <div class="nav-item" onclick="navegar('minhas_musicas')">üé∂ Minhas M√∫sicas</div>
        <div class="nav-item" onclick="navegar('carteira')">üí∞ Carteira & Saques</div>
        <div id="adminBtn" class="nav-item" onclick="navegar('admin')" style="display:none; color:var(--gold); border: 1px solid var(--gold);">üõ°Ô∏è PAINEL CEO</div>
        <div class="nav-item" onclick="sair()" style="color:#ff4d4d; margin-top:auto;">üö™ Terminar Sess√£o</div>
    </nav>

    <div id="app" class="hidden">
        <div id="mainDiv" class="main">
            
            <div id="home" class="section active-section">
                <div class="card">
                    <h3>Notas de Boas-Vindas</h3>
                    <p id="boasVindasText"></p>
                </div>
                <div class="card">
                    <h3>üìÄ M√∫sica em Destaque</h3>
                    <p><b>F√© em Deus</b> - Princesa Heliany ft Play Sean Ars√©nio</p>
                </div>
                <div class="card">
                    <h3>üí∞ Centro de Ganhos (Tarefas Ativas)</h3>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                        <button class="btn-gold" style="font-size:0.7em;" onclick="execTarefa(50, 'Assistir V√≠deo')">üìπ V√≠deo Pago (+50 KZ)</button>
                        <button class="btn-gold" style="font-size:0.7em;" onclick="execTarefa(150, 'Follow TikTok')">üì± TikTok CEO (+150 KZ)</button>
                    </div>
                </div>
                <div class="card" style="border-left: 4px solid var(--blue);">
                    <h3>üì¢ Informa√ß√µes Banc√°rias MAM</h3>
                    <p>Apoie a curadoria independente: <br><b>IBAN:</b> AO06 0040 0000 1234 5678 1012 3 <br><b>Titular:</b> Matias Manuel</p>
                </div>
            </div>

            <div id="perfil" class="section">
                <div class="card">
                    <h3>Configura√ß√µes de Perfil</h3>
                    <p>Nome de Exibi√ß√£o:</p>
                    <input type="text" id="editNome">
                    <p>Alterar Foto (URL):</p>
                    <input type="text" id="editFoto" placeholder="Link da imagem">
                    <button class="btn-gold" onclick="salvarPerfil()">Atualizar Dados</button>
                </div>
            </div>

            <div id="lancar" class="section">
                <div class="card">
                    <h3>Formul√°rio de Lan√ßamento ISRC</h3>
                    <input type="text" id="musicaTitulo" placeholder="T√≠tulo da Obra">
                    <input type="text" id="musicaArtista" placeholder="Artista Principal">
                    <select id="musicaCat">
                        <option>Kizomba / Semba</option><option>Rap / Hip-Hop</option><option>Gospel</option><option>Kuduro</option>
                    </select>
                    <p>Data de Lan√ßamento:</p>
                    <input type="date" id="musicaData">
                    <p>Capa (JPG) e √Åudio (WAV):</p>
                    <input type="file" multiple>
                    <button class="btn-gold" onclick="enviarLancamento()">Submeter para Distribui√ß√£o</button>
                </div>
            </div>

            <div id="minhas_musicas" class="section">
                <h3>O Meu Cat√°logo</h3>
                <div id="containerMusicas"></div>
            </div>

            <div id="carteira" class="section">
                <div class="card" style="text-align:center;">
                    <small>Saldo Total Acumulado</small>
                    <h1 id="saldoExibido" style="font-size:3em; color:var(--gold); margin:10px 0;">0 KZ</h1>
                </div>
                <div class="card">
                    <h3>Solicitar Levantamento</h3>
                    <select id="saqueBanco">
                        <option>BAI</option><option>BFA</option><option>BIC</option><option>Multicaixa Express</option>
                        <option>PayPal</option><option>Wise/Visa</option><option>Pix</option>
                    </select>
                    <input type="number" id="saqueValor" placeholder="Quantia em KZ">
                    <input type="text" id="saqueDestino" placeholder="IBAN ou E-mail de destino">
                    <button class="btn-gold" onclick="executarSaque()">Confirmar Saque</button>
                </div>
            </div>

            <div id="admin" class="section">
                <div class="card">
                    <h3>Gest√£o Administrativa (MAM)</h3>
                    <div id="adminStats"></div>
                </div>
            </div>

        </div>
        <footer><b>MAM DISTRIBUIDORA</b> | C.E.O Matias Ars√©nio Manuel | Angola 2026</footer>
    </div>

    <script>
        // BASE DE DADOS REAL EM LOCALSTORAGE
        let usuarios = JSON.parse(localStorage.getItem('mam_users')) || [];
        let logado = JSON.parse(localStorage.getItem('mam_session')) || null;
        let catalogo = JSON.parse(localStorage.getItem('mam_catalogo')) || [];

        function irParaRegisto() { document.getElementById('loginBox').classList.add('hidden'); document.getElementById('regBox').classList.remove('hidden'); }
        function irParaLogin() { document.getElementById('regBox').classList.add('hidden'); document.getElementById('loginBox').classList.remove('hidden'); }

        function registrar() {
            const n = document.getElementById('rNome').value;
            const e = document.getElementById('rEmail').value;
            const p = document.getElementById('rPass').value;
            if(!n || !e || !p) return alert("Erro: Todos os campos s√£o obrigat√≥rios.");
            if(usuarios.find(u => u.email === e)) return alert("Erro: E-mail j√° registado.");
            
            usuarios.push({nome: n, email: e, pass: p, saldo: 5000, foto: "https://via.placeholder.com/100", role: 'USER'});
            localStorage.setItem('mam_users', JSON.stringify(usuarios));
            alert("Registo conclu√≠do! Bem-vindo √† MAM.");
            irParaLogin();
        }

        function autenticar() {
            const e = document.getElementById('lEmail').value;
            const p = document.getElementById('lPass').value;
            
            if(e === "mamfilhos29@gmail.com") { // ACESSO DIRETOR
                logado = {nome: "Matias CEO", email: e, role: "ADMIN", saldo: 999999, foto: "https://via.placeholder.com/100"};
            } else {
                let user = usuarios.find(u => u.email === e && u.pass === p);
                if(!user) return alert("Credenciais Inv√°lidas.");
                logado = user;
            }
            
            localStorage.setItem('mam_session', JSON.stringify(logado));
            location.reload();
        }

        function carregarPainel() {
            if(!logado) return;
            document.getElementById('authPage').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('mainDiv').classList.add('logged-main');
            
            document.getElementById('sideNome').innerText = logado.nome;
            document.getElementById('sidePic').src = logado.foto;
            document.getElementById('boasVindasText').innerText = "Bem-vindo, " + logado.nome + ". O teu painel de distribui√ß√£o est√° ativo.";
            atualizarInterfaceFinanceira();
            renderCatalogo();
            
            if(logado.role === "ADMIN") document.getElementById('adminBtn').style.display = 'block';
        }

        function navegar(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active-section'));
            document.getElementById(id).classList.add('active-section');
            if(window.innerWidth < 900) document.getElementById('sidebar').style.display = 'none';
        }

        function atualizarInterfaceFinanceira() {
            document.getElementById('saldoExibido').innerText = logado.saldo.toLocaleString() + " KZ";
        }

        function execTarefa(valor, tarefa) {
            logado.saldo += valor;
            // Atualizar na base de dados global
            if(logado.role !== "ADMIN") {
                let idx = usuarios.findIndex(u => u.email === logado.email);
                usuarios[idx].saldo = logado.saldo;
                localStorage.setItem('mam_users', JSON.stringify(usuarios));
            }
            localStorage.setItem('mam_session', JSON.stringify(logado));
            alert("Sucesso: " + tarefa + " conclu√≠do. +" + valor + " KZ adicionados.");
            atualizarInterfaceFinanceira();
        }

        function enviarLancamento() {
            const t = document.getElementById('musicaTitulo').value;
            const a = document.getElementById('musicaArtista').value;
            if(!t || !a) return alert("Preencha os dados da m√∫sica.");
            
            let novaMusica = { 
                id: Date.now(), 
                owner: logado.email, 
                titulo: t, 
                artista: a, 
                status: 'Pendente', 
                data: new Date().toLocaleDateString() 
            };
            
            catalogo.push(novaMusica);
            localStorage.setItem('mam_catalogo', JSON.stringify(catalogo));
            alert("Lan√ßamento submetido para curadoria MAM!");
            renderCatalogo();
            navegar('minhas_musicas');
        }

        function renderCatalogo() {
            const container = document.getElementById('containerMusicas');
            let minhas = catalogo.filter(m => m.owner === logado.email);
            if(minhas.length === 0) {
                container.innerHTML = "<p>Nenhuma m√∫sica enviada.</p>";
                return;
            }
            container.innerHTML = minhas.map(m => `
                <div class="card">
                    <b>${m.titulo}</b> - ${m.artista} <br>
                    <small>Submetido em: ${m.data}</small> 
                    <span class="status-badge pendente">${m.status}</span>
                </div>
            `).join('');
        }

        function executarSaque() {
            const val = Number(document.getElementById('saqueValor').value);
            if(val <= 0 || val > logado.saldo) return alert("Valor inv√°lido ou insuficiente.");
            
            logado.saldo -= val;
            if(logado.role !== "ADMIN") {
                let idx = usuarios.findIndex(u => u.email === logado.email);
                usuarios[idx].saldo = logado.saldo;
                localStorage.setItem('mam_users', JSON.stringify(usuarios));
            }
            localStorage.setItem('mam_session', JSON.stringify(logado));
            alert("Pedido de levantamento enviado √† administra√ß√£o MAM.");
            atualizarInterfaceFinanceira();
        }

        function salvarPerfil() {
            logado.nome = document.getElementById('editNome').value || logado.nome;
            logado.foto = document.getElementById('editFoto').value || logado.foto;
            localStorage.setItem('mam_session', JSON.stringify(logado));
            location.reload();
        }

        function sair() { localStorage.removeItem('mam_session'); location.reload(); }

        carregarPainel();
    </script>
</body>
</html>
