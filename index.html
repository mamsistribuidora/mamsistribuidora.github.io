<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAM Distribuidora | Oficial</title>
    <style>
        :root { --gold: #FFD700; --blue: #002d5a; --card: rgba(10, 10, 10, 0.95); }
        body { 
            font-family: 'Segoe UI', sans-serif; margin: 0; min-height: 100vh; color: #fff;
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('https://images.unsplash.com/photo-1598488035139-bdbb2231ce04?q=80&w=1470&auto=format&fit=crop'); 
            background-size: cover; background-attachment: fixed; background-position: center;
        }
        .sidebar { width: 280px; background: #000; height: 100vh; position: fixed; border-right: 2px solid var(--blue); display: none; flex-direction: column; padding: 20px; box-sizing: border-box; z-index: 1000; overflow-y: auto; }
        .main { width: 100%; box-sizing: border-box; transition: 0.3s; }
        .logged-main { padding-left: 280px; }
        @media (max-width: 900px) { .logged-main { padding-left: 0; } .sidebar { width: 100%; height: auto; position: relative; } }
        .section { padding: 25px; display: none; max-width: 1200px; margin: auto; }
        .active-section { display: block; }
        .card { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; border-left: 4px solid var(--gold); }
        input, select { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid var(--gold); color: #fff; border-radius: 6px; }
        .btn-gold { background: var(--gold); color: #000; padding: 14px; border: none; border-radius: 6px; font-weight: bold; width: 100%; cursor: pointer; text-transform: uppercase; margin-top: 10px; }
        .nav-item { padding: 14px; cursor: pointer; border-bottom: 1px solid #222; }
        .profile-pic { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--gold); object-fit: cover; display: block; margin: auto; background: #222; }
        .hidden { display: none !important; }
        footer { background: #000; padding: 30px; text-align: center; border-top: 2px solid var(--blue); }
    </style>
</head>
<body>

    <div id="authPage" style="height:95vh; display:flex; align-items:center; justify-content:center; padding:20px;">
        <div class="card" style="width:100%; max-width:400px; text-align:center;">
            <h1 style="color:var(--gold); font-size:3em; margin:0;">MAM</h1>
            <p>Distribuidora Profissional</p>
            
            <div id="loginBox">
                <input type="email" id="lEmail" placeholder="E-mail">
                <input type="password" id="lPass" placeholder="Senha">
                <button class="btn-gold" onclick="entrar()">Iniciar Sess√£o</button>
                <p style="margin-top:15px;">√â novo? <b onclick="abrirReg()" style="color:var(--gold); cursor:pointer;">Criar Conta</b></p>
            </div>

            <div id="regBox" class="hidden">
                <input type="text" id="rNome" placeholder="Nome Completo">
                <input type="email" id="rEmail" placeholder="E-mail">
                <input type="password" id="rPass" placeholder="Criar Senha">
                <button class="btn-gold" onclick="cadastrar()">Finalizar Cadastro</button>
                <p style="margin-top:15px;">J√° tem conta? <b onclick="abrirLog()" style="color:var(--gold); cursor:pointer;">Fazer Login</b></p>
            </div>
        </div>
    </div>

    <nav id="sidebar" class="sidebar">
        <div style="text-align:center; margin-bottom:20px;">
            <img id="sidePic" src="https://via.placeholder.com/100" class="profile-pic">
            <p id="sideNome" style="color:var(--gold); font-weight:bold; margin-top:12px;"></p>
        </div>
        <div class="nav-item" onclick="navegar('home')">üè† In√≠cio</div>
        <div class="nav-item" onclick="navegar('perfil')">üë§ Editar Perfil (Foto/Nome)</div>
        <div class="nav-item" onclick="navegar('lancar')">üöÄ Lan√ßamento Profissional</div>
        <div class="nav-item" onclick="navegar('minhas_musicas')">üé∂ Minhas M√∫sicas</div>
        <div class="nav-item" onclick="navegar('carteira')">üí∞ Carteira Dupla</div>
        <div id="adminBtn" class="nav-item" onclick="navegar('admin')" style="display:none; color:var(--gold); border: 1px solid var(--gold);">üõ°Ô∏è PAINEL CEO</div>
        <div class="nav-item" onclick="sair()" style="color:#ff4d4d; margin-top:20px;">üö™ Sair</div>
    </nav>

    <div id="app" class="hidden">
        <div id="mainDiv" class="main">
            
            <div id="home" class="section active-section">
                <div class="card">
                    <h3>Bem-vindo √† MAM</h3>
                    <p>Ol√°, <span id="welcomeName"></span>! Gerimos a tua m√∫sica com curadoria real.</p>
                </div>
                <div class="card">
                    <h3>üìÄ Destaque: F√© em Deus</h3>
                    <p>Princesa Heliany ft Play Sean Ars√©nio</p>
                </div>
                <div class="card">
                    <h3>üöÄ Ganhar Dinheiro (Tarefas)</h3>
                    <button class="btn-gold" style="width:auto; padding:8px;" onclick="ganhar(100)">üìπ Ver V√≠deo (+100 KZ)</button>
                    <button class="btn-gold" style="width:auto; padding:8px;" onclick="ganhar(250)">üì± Seguir TikTok CEO (+250 KZ)</button>
                </div>
                <div class="card" style="border-left:4px solid var(--blue);">
                    <h3>üì¢ Apoio ao Projeto</h3>
                    <p><b>IBAN:</b> AO06 0040 0000 1234 5678 1012 3 (Matias Manuel)</p>
                </div>
            </div>

            <div id="perfil" class="section">
                <div class="card">
                    <h3>Editar Perfil</h3>
                    <p>Carregar Foto Real:</p>
                    <input type="file" accept="image/*" onchange="subirFoto(this)">
                    <p>Nome Art√≠stico:</p>
                    <input type="text" id="novoNomeInput" placeholder="Novo nome">
                    <button class="btn-gold" onclick="mudarNome()">Salvar Altera√ß√µes</button>
                </div>
            </div>

            <div id="lancar" class="section">
                <div class="card">
                    <h3>Lan√ßamento Profissional</h3>
                    <input type="text" id="trackTitle" placeholder="T√≠tulo da M√∫sica">
                    <select><option>Kizomba</option><option>Gospel</option><option>Rap</option></select>
                    <input type="file" multiple>
                    <button class="btn-gold" onclick="enviarTrack()">Submeter M√∫sica</button>
                </div>
            </div>

            <div id="minhas_musicas" class="section">
                <h3>Minhas M√∫sicas</h3>
                <div id="trackList"></div>
            </div>

            <div id="carteira" class="section">
                <div class="card">
                    <small>Teu Saldo Artista:</small>
                    <h1 id="artistaSaldo" style="color:var(--gold); font-size:2.5em;">0 KZ</h1>
                </div>
                <div id="cardCEO" class="card" style="display:none; background:var(--blue);">
                    <small>Lucro Empresa MAM (80%):</small>
                    <h1 id="ceoSaldo" style="color:#fff;">0 KZ</h1>
                </div>
                <div class="card">
                    <h3>Levantamento</h3>
                    <select id="bancoSelect"><option>BAI</option><option>BFA</option><option>PayPal</option><option>Wise</option></select>
                    <input type="number" id="valorSacar" placeholder="Valor">
                    <button class="btn-gold" onclick="sacarReal()">Solicitar Saque</button>
                </div>
            </div>

            <div id="admin" class="section">
                <div class="card"><h3>Gest√£o CEO</h3><p>Painel de controlo de Matias Ars√©nio Manuel.</p></div>
            </div>
        </div>
        <footer><b>MAM DISTRIBUIDORA</b> | C.E.O Matias Ars√©nio Manuel | 2026</footer>
    </div>

    <script>
        const CEO_EMAIL = "mamfilhos29@gmail.com";
        let db = JSON.parse(localStorage.getItem('mam_final_db')) || [];
        let user = JSON.parse(localStorage.getItem('mam_final_sess')) || null;
        let musicas = JSON.parse(localStorage.getItem('mam_final_musicas')) || [];
        let lucroGeral = Number(localStorage.getItem('mam_final_lucro')) || 1500000;

        function abrirReg() { document.getElementById('loginBox').classList.add('hidden'); document.getElementById('regBox').classList.remove('hidden'); }
        function abrirLog() { document.getElementById('regBox').classList.add('hidden'); document.getElementById('loginBox').classList.remove('hidden'); }

        function cadastrar() {
            const n = document.getElementById('rNome').value, e = document.getElementById('rEmail').value, p = document.getElementById('rPass').value;
            if(!n || !e || !p) return alert("Preencha tudo!");
            db.push({nome: n, email: e, pass: p, saldo: 5000, foto: ""});
            localStorage.setItem('mam_final_db', JSON.stringify(db));
            alert("Registado com b√≥nus de 5.000 KZ!"); abrirLog();
        }

        function entrar() {
            const e = document.getElementById('lEmail').value, p = document.getElementById('lPass').value;
            if(e === CEO_EMAIL) {
                user = {nome: "Matias CEO", email: e, role: "ADMIN", saldo: 500000, foto: ""};
            } else {
                let u = db.find(x => x.email === e && x.pass === p);
                if(!u) return alert("Login Inv√°lido!");
                user = u;
            }
            localStorage.setItem('mam_final_sess', JSON.stringify(user));
            location.reload();
        }

        function carregar() {
            if(!user) return;
            document.getElementById('authPage').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('mainDiv').classList.add('logged-main');
            document.getElementById('sideNome').innerText = user.nome;
            document.getElementById('welcomeName').innerText = user.nome;
            if(user.foto) document.getElementById('sidePic').src = user.foto;
            
            if(user.role === "ADMIN") {
                document.getElementById('adminBtn').style.display = 'block';
                document.getElementById('cardCEO').style.display = 'block';
            }
            refresh();
        }

        function navegar(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active-section'));
            document.getElementById(id).classList.add('active-section');
            if(window.innerWidth < 900) document.getElementById('sidebar').style.display = 'none';
        }

        function subirFoto(input) {
            if (input.files && input.files[0]) {
                let r = new FileReader();
                r.onload = function(e) {
                    user.foto = e.target.result;
                    document.getElementById('sidePic').src = e.target.result;
                    salvar();
                };
                r.readAsDataURL(input.files[0]);
            }
        }

        function mudarNome() {
            const n = document.getElementById('novoNomeInput').value;
            if(n) { user.nome = n; salvar(); location.reload(); }
        }

        function ganhar(q) {
            user.saldo += q;
            lucroGeral += (q * 0.8);
            alert("Ganhaste " + q + " KZ!");
            salvar();
        }

        function enviarTrack() {
            const t = document.getElementById('trackTitle').value;
            if(!t) return alert("T√≠tulo vazio!");
            musicas.push({titulo: t, dono: user.email, status: "Distribuindo"});
            localStorage.setItem('mam_final_musicas', JSON.stringify(musicas));
            alert("M√∫sica enviada!");
            refresh(); navegar('minhas_musicas');
        }

        function refresh() {
            document.getElementById('artistaSaldo').innerText = user.saldo.toLocaleString() + " KZ";
            document.getElementById('ceoSaldo').innerText = lucroGeral.toLocaleString() + " KZ";
            const lista = document.getElementById('trackList');
            let minhas = musicas.filter(m => m.dono === user.email);
            lista.innerHTML = minhas.map(m => `<div class="card"><b>${m.titulo}</b> - ${m.status}</div>`).join('');
        }

        function sacarReal() {
            const v = Number(document.getElementById('valorSacar').value);
            if(v > user.saldo || v <= 0) return alert("Saldo insuficiente.");
            user.saldo -= v;
            alert("Pedido de saque enviado ao Diretor Matias.");
            salvar();
        }

        function salvar() {
            localStorage.setItem('mam_final_sess', JSON.stringify(user));
            localStorage.setItem('mam_final_lucro', lucroGeral);
            if(user.role !== "ADMIN") {
                let idx = db.findIndex(u => u.email === user.email);
                db[idx] = user;
                localStorage.setItem('mam_final_db', JSON.stringify(db));
            }
            refresh();
        }

        function sair() { localStorage.removeItem('mam_final_sess'); location.reload(); }
        carregar();
    </script>
</body>
</html>
