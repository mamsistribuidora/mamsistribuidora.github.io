<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAM Distribuidora | Oficial</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --gold: #D4AF37; --bg: #0d0d0d; --card: #161616; --side: #000000; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: #fff; height: 100vh; overflow: hidden; }

        /* TELA DE LOGIN / REGISTO */
        #authContainer {
            position: fixed; inset: 0; z-index: 9999; background: radial-gradient(circle, #1a1a1a, #000);
            display: flex; align-items: center; justify-content: center;
        }
        .auth-card {
            background: rgba(20,20,20,0.95); border: 1px solid var(--gold); padding: 40px;
            border-radius: 20px; width: 380px; text-align: center; backdrop-filter: blur(10px);
        }
        .auth-card img { width: 80px; border-radius: 50%; border: 2px solid var(--gold); margin-bottom: 20px; }

        /* LAYOUT PRINCIPAL (ID√äNTICO AO IMAC) */
        #mainApp { display: grid; grid-template-columns: 260px 1fr; height: 100vh; }
        
        /* SIDEBAR PROFISSIONAL */
        .sidebar { background: var(--side); border-right: 1px solid #222; padding: 25px; display: flex; flex-direction: column; }
        .logo-box { text-align: center; margin-bottom: 40px; }
        .logo-box img { width: 130px; border-radius: 50%; border: 2px solid var(--gold); }
        
        .nav-link { 
            display: flex; align-items: center; gap: 15px; padding: 14px 18px; 
            color: #888; text-decoration: none; border-radius: 12px; margin-bottom: 8px;
            cursor: pointer; transition: 0.3s; font-size: 0.9rem;
        }
        .nav-link:hover, .nav-active { background: linear-gradient(90deg, #D4AF3733, transparent); color: var(--gold); border-left: 4px solid var(--gold); }
        .nav-link i { font-size: 1.2rem; }

        /* √ÅREA DE CONTE√öDO */
        .viewport { overflow-y: auto; background: linear-gradient(135deg, #0d0d0d 0%, #1a1a1a 100%); position: relative; }
        header { 
            padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; 
            background: rgba(0,0,0,0.3); backdrop-filter: blur(5px); sticky; top: 0; z-index: 100;
        }
        .search-bar { background: #1a1a1a; border: 1px solid #333; border-radius: 30px; padding: 10px 25px; width: 400px; color: #fff; outline: none; }

        /* CARDS DE M√öSICA (ESTILO VINIL) */
        .content-grid { padding: 40px; display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 30px; }
        .music-card { text-align: center; transition: 0.3s; }
        .music-card:hover { transform: translateY(-5px); }
        .vinyl { 
            width: 100%; aspect-ratio: 1/1; border-radius: 50%; border: 5px solid #1a1a1a; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); margin-bottom: 12px; object-fit: cover;
        }

        /* BOT√ïES E INPUTS */
        .btn-mam { background: var(--gold); color: #000; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #111; border: 1px solid #333; color: #fff; border-radius: 8px; }

        /* RODAP√â EXCLUSIVO MAM */
        .footer-tag { 
            position: fixed; bottom: 20px; left: 20px; background: rgba(0,0,0,0.8); 
            border: 1px solid #333; padding: 8px 15px; border-radius: 8px; 
            display: flex; align-items: center; gap: 10px; z-index: 1000;
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="authContainer">
    <div class="auth-card">
        <img src="https://i.ibb.co/LhqZz1L/mam-logo.jpg">
        <h2 id="authTitle" style="color:var(--gold); margin-bottom: 5px;">MAM Login</h2>
        <p style="font-size:0.7rem; color:#666; margin-bottom:20px;">Curadoria de Elite [Matias Manuel]</p>
        
        <input type="email" id="email" placeholder="E-mail">
        <input type="password" id="pass" placeholder="Palavra-passe">
        <button class="btn-mam" onclick="autenticar()">ENTRAR NO PAINEL</button>
        
        <p style="margin-top:20px; font-size:0.8rem;">
            <span id="toggleText">Ainda n√£o tem conta?</span> 
            <b style="color:var(--gold); cursor:pointer;" onclick="alternarAuth()">Clique aqui</b>
        </p>
    </div>
</div>

<div id="mainApp" class="hidden">
    <aside class="sidebar">
        <div class="logo-box">
            <img src="https://i.ibb.co/LhqZz1L/mam-logo.jpg">
        </div>
        <nav>
            <div class="nav-link nav-active" onclick="navegar('home')">üè† P√°gina Inicial</div>
            <div class="nav-link" onclick="navegar('perfil')">üë§ Meu Perfil</div>
            <div class="nav-link" onclick="navegar('artista')">üë®‚Äçüé® Criar Artista</div>
            <div class="nav-link" onclick="navegar('lancar')">üì§ Lan√ßar M√∫sica</div>
            <div class="nav-link" onclick="navegar('carteira')">üí∞ Minha Carteira</div>
            <div class="nav-link" onclick="navegar('ceo')">üëî Informa√ß√£o CEO</div>
            <div class="nav-link" style="color:#ff4444; margin-top:20px;" onclick="sair()">üö™ Terminar Sess√£o</div>
        </nav>
    </aside>

    <main class="viewport">
        <header>
            <input type="text" class="search-bar" placeholder="Pesquisar m√∫sicas, artistas ou produtores...">
            <div style="display:flex; align-items:center; gap:15px;">
                <span id="userSaldo" style="color:var(--gold); font-weight:bold;">1.000,00 Kz</span>
                <img id="userThumb" src="" style="width:35px; height:35px; border-radius:50%; border:1px solid var(--gold);">
            </div>
        </header>

        <section id="viewHome" class="view">
            <div style="padding: 40px 40px 0;">
                <h2>Feed de Lan√ßamentos</h2>
                <p style="color:#666; font-size:0.9rem;">As √∫ltimas novidades da MAM Distribuidora.</p>
            </div>
            <div class="content-grid" id="listaMusicas">
                </div>
        </section>

        <section id="viewLancar" class="view hidden" style="padding:40px;">
            <h2>Lan√ßar Nova Obra</h2>
            <div style="max-width:500px; margin-top:20px;">
                <input type="text" id="mTitulo" placeholder="T√≠tulo da M√∫sica">
                <input type="file" id="mCapa" accept="image/*">
                <button class="btn-mam" onclick="processarLancamento()">PUBLICAR AGORA</button>
            </div>
        </section>
    </main>
</div>

<div class="footer-tag">
    <img src="https://i.ibb.co/LhqZz1L/mam-logo.jpg" style="width:25px; border-radius:50%;">
    <span style="font-size:0.7rem; letter-spacing:1px;">MAM DISTRIBUIDORA</span>
</div>

<script>
    // CONFIGURA√á√ÉO FIREBASE [cite: 2026-01-27]
    const firebaseConfig = {
        apiKey: "AIzaSyBBsZS8EpszUtikaKS8B5te8C7Q9Ow-9wo",
        authDomain: "mam-distribuidora.firebaseapp.com",
        projectId: "mam-distribuidora",
        storageBucket: "mam-distribuidora.appspot.com",
        messagingSenderId: "670857002452",
        appId: "1:670857002452:web:404822b5376075e520ea41"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let modoLogin = true;

    function alternarAuth() {
        modoLogin = !modoLogin;
        document.getElementById('authTitle').innerText = modoLogin ? "MAM Login" : "Criar Conta MAM";
        document.getElementById('toggleText').innerText = modoLogin ? "Ainda n√£o tem conta?" : "J√° tem uma conta?";
    }

    async function autenticar() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('pass').value;
        try {
            if(modoLogin) {
                await auth.signInWithEmailAndPassword(e, p);
            } else {
                const cred = await auth.createUserWithEmailAndPassword(e, p);
                await db.collection("users").doc(cred.user.uid).set({
                    nome: "MAM Artist",
                    saldo: 1000,
                    foto: "",
                    email: e
                });
                alert("Conta criada! Ganhaste 1000 Kz de b√≥nus [cite: 2026-01-28]");
            }
        } catch(err) { alert("Erro: " + err.message); }
    }

    auth.onAuthStateChanged(user => {
        if(user) {
            document.getElementById('authContainer').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            db.collection("users").doc(user.uid).onSnapshot(doc => {
                const d = doc.data();
                document.getElementById('userSaldo').innerText = d.saldo.toLocaleString() + ",00 Kz";
                document.getElementById('userThumb').src = d.foto || 'https://i.ibb.co/LhqZz1L/mam-logo.jpg';
            });
            carregarMusicas();
        } else {
            document.getElementById('authContainer').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }
    });

    function navegar(onde) {
        document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
        document.getElementById('view' + onde.charAt(0).toUpperCase() + onde.slice(1)).classList.remove('hidden');
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('nav-active'));
        event.currentTarget.classList.add('nav-active');
    }

    function carregarMusicas() {
        db.collection("musicas").onSnapshot(snap => {
            const container = document.getElementById('listaMusicas');
            container.innerHTML = "";
            snap.forEach(doc => {
                const m = doc.data();
                container.innerHTML += `
                    <div class="music-card">
                        <img src="${m.capa}" class="vinyl">
                        <h4 style="color:var(--gold); font-size:0.9rem;">${m.titulo}</h4>
                        <p style="font-size:0.7rem; color:#777;">${m.artista || 'MAM Artist'}</p>
                    </div>
                `;
            });
        });
    }

    function sair() { auth.signOut(); }
</script>
</body>
</html>
